#!/bin/sh -e

export DESTDIR="$1"

cmake -B build \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DDISABLE_WERROR=ON \
    -DLWS_IPV6=ON \
    -DLWS_WITH_THREADPOOL=ON \
    -DLWS_WITH_LIBUV=ON \
    -DLWS_WITHOUT_BUILTIN_GETIFADDRS=ON \
    -DLWS_WITHOUT_BUILTIN_SHA1=ON \
    -DLWS_WITHOUT_CLIENT=OFF \
    -DLWS_WITHOUT_SERVER=OFF \
    -DLWS_WITHOUT_TESTAPPS=ON \
    -DLWS_WITHOUT_TEST_CLIENT=ON \
    -DLWS_WITHOUT_TEST_PING=ON \
    -DLWS_WITHOUT_TEST_SERVER=OFF \
    -DLWS_WITHOUT_TEST_SERVER_EXTPOLL=ON \
    -DLWS_UNIX_SOCK=ON

cmake --build build
cmake --install build
